<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title><?=$new_businesses_text?> - <?=$website_name?> <?=$admin_center?></title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="icon" type="image/png" href="templates/assets/i/favicon.png">
  <link rel="apple-touch-icon-precomposed" href="templates/assets/i/app-icon72x72@2x.png">
  <meta name="apple-mobile-web-app-title" content="Amaze UI" />
  <link rel="stylesheet" href="templates/assets/css/amazeui.min.css"/>
  <link rel="stylesheet" href="templates/assets/css/admin.css">
  <link href="/js/umeditor/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
  <script type="text/javascript">

window.onload=function(){
	  t1();//商户名称检测
	   t5();//地图坐标检测
	   t6();//分享信息检测
          t6s();//地址
	   t7();//联系人
	  t2();//电话号码检测
	  t8();//营业时间
	  t9();//所需二维码数量
	
	}

function t1(){
  //获取节点username
            var user = document.getElementsByName('sellerName')[0];
            var first = document.getElementById('first');
            var one = document.getElementById('one');
    //获取焦点
    user.onfocus=function(){
        user.setAttribute('placeholder','<?=$restaurant_name_text?>');
    }
    //失去焦点
    user.onblur=function(){
    //客户端正则判断是否合法
        if(user.value==''){
         first.setAttribute('class','am-icon-times');
         first.setAttribute('style','display;margin-right:20px;');
          first.innerHTML="<font color='red'><?php echo $restaurant_name_text,$doest_null;?></font>";
          one.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            var uri = "ajax_seller.php?sellerName="+user.value;
            //ajax异步验证,第一步初始化
            var nokia = tel();
            nokia.open('GET',uri,true);//第二步，open 操作true异步
            nokia.onreadystatechange = function(){ //第三步onreadystatachange
                if(nokia.readyState==4){//状态响应为4说明请求正常回应
                    if(nokia.responseText == 0){//第4步，根据不同的响应结果进行操作
                        first.setAttribute('class','am-icon-check');
                        first.innerHTML = "";
                        first.setAttribute('style','display;margin-right:20px;');
                        one.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
                    }else{
                        first.setAttribute('class','am-icon-times');
                        first.setAttribute('style','display;margin-right:20px;');
                        first.innerHTML = "<font color='red'><?php echo $restaurant_name_text,$repeat_text;?></font>";
                        one.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
                    }
                }
            }
            //第5步，发送
            nokia.send(null);
        }
    }
    function tel(){
    //ie和火狐兼容性
        var phone = false;
        if(window.XMLHttpRequest){
            phone = new XMLHttpRequest();
        }else{
            phone = new window.ActiveXObject('Microsoft.XMLHttp');
        }
        return phone;
    }
}
function t2(){
            var phone = document.getElementsByName('tel')[0];
            var second = document.getElementById('second');
            var two = document.getElementById('two');
        phone.onfocus=function(){
        phone.setAttribute('placeholder','<?php echo $please_write,$phone_text;?>');
    }
    phone.onblur = function(){
        if(phone.value==''){
           second.setAttribute('class','am-icon-times');
           second.setAttribute('style','display;margin-right:20px;');
          second.innerHTML="<font color='red'><?php echo $phone_text,$doest_null;?></font>";
          two.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            second.setAttribute('class','am-icon-check');
            second.setAttribute('style','display;margin-right:20px;');
            second.innerHTML = "";
            two.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }

 function t5(){
            var map = document.getElementsByName('coordinates')[0];
            var fifth = document.getElementById('fifth');
            var five = document.getElementById('five');
        map.onfocus=function(){

        map.setAttribute('placeholder','<?php echo $please_write,$map_coordinates_text;?>');
    }
    map.onblur = function(){
        if(map.value==''){
          fifth.setAttribute('class','am-icon-times');
          fifth.setAttribute('style','display;margin-right:20px;');
          fifth.innerHTML="<font color='red'><?php echo $map_coordinates_text,$doest_null;?></font>";
          five.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            fifth.setAttribute('class','am-icon-check');
            fifth.innerHTML = "";
            fifth.setAttribute('style','display;margin-right:20px;');
            five.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }
  function t6(){
            var address = document.getElementsByName('address')[0];
            var sixth = document.getElementById('sixth');
            var six = document.getElementById('six');
        address.onfocus=function(){

        address.setAttribute('placeholder','<?php echo $please_write,$share_information_text;?>');
    }
    address.onblur = function(){
        if(address.value==''){
          sixth.setAttribute('class','am-icon-times');
          sixth.setAttribute('style','display;margin-right:20px;');
          sixth.innerHTML="<font color='red'><?php echo $share_information_text,$doest_null;?></font>";
          six.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            sixth.setAttribute('class','am-icon-check');
            sixth.innerHTML = "";
            sixth.setAttribute('style','display;margin-right:20px;');
            six.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }
   function t6s(){
            var address = document.getElementsByName('mer_address')[0];
            var sth = document.getElementById('sth');
            var s = document.getElementById('s');
        address.onfocus=function(){

        address.setAttribute('placeholder','<?php echo $please_write,$merchant_address_text;?>');
    }
    address.onblur = function(){
        if(address.value==''){
          sth.setAttribute('class','am-icon-times');
          sth.setAttribute('style','display;margin-right:20px;');
          sth.innerHTML="<font color='red'><?php echo $merchant_address_text,$doest_null;?></font>";
          s.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            sth.setAttribute('class','am-icon-check');
            sth.innerHTML = "";
            sth.setAttribute('style','display;margin-right:20px;');
            s.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }
   function t7(){
            var contacts = document.getElementsByName('contacts')[0];
            var seventh = document.getElementById('seventh');
            var seven = document.getElementById('seven');
        contacts.onfocus=function(){

        contacts.setAttribute('placeholder','<?php echo $please_write,$contact_person_text;?>');
    }
    contacts.onblur = function(){
        if(contacts.value==''){
          seventh.setAttribute('class','am-icon-times');
          seventh.setAttribute('style','display;margin-right:20px;');
          seventh.innerHTML="<font color='red'><?php echo $contact_person_text,$doest_null;?></font>";
          seven.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            seventh.setAttribute('class','am-icon-check');
            seventh.innerHTML = "";
            seventh.setAttribute('style','display;margin-right:20px;');
            seven.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }
    function t8(){
            var business_hour = document.getElementsByName('BH')[0];
            var eighth = document.getElementById('eighth');
            var eight = document.getElementById('eight');

        business_hour.onfocus=function(){
       business_hour.setAttribute('placeholder','<?php echo $please_write,$business_hour_text;?>');
    }
    business_hour .onblur = function(){
        if(business_hour .value==''){
          eighth.setAttribute('class','am-icon-times');
          eighth.setAttribute('style','display;margin-right:20px;');
          eighth.innerHTML="<font color='red'><?php echo $business_hour_text,$doest_null;?></font>";
          eight.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            eighth.setAttribute('class','am-icon-check');
            eighth.setAttribute('style','display;margin-right:20px;');
            eighth.innerHTML = "";
            eight.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }
     function t9(){
            var QRcode_sum = document.getElementsByName('QRcode_sum')[0];
            var nineth = document.getElementById('nineth');
            var nine = document.getElementById('nine');

        QRcode_sum.onfocus=function(){
       QRcode_sum.setAttribute('placeholder','<?php echo $please_write,$required_QRcode_number_text;?>');
    }
    QRcode_sum .onblur = function(){
        if(QRcode_sum .value==''){
          nineth.setAttribute('class','am-icon-times');
          nineth.setAttribute('style','display;margin-right:20px;');
          nineth.innerHTML="<font color='red'><?php echo $required_QRcode_number_text,$doest_null;?></font>";
          nine.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else if(isNaN(QRcode_sum.value)){
          nineth.setAttribute('class','am-icon-times');
          nineth.setAttribute('style','display;margin-right:20px;');
          nineth.innerHTML="<font color='red'><?php echo $required_QRcode_number_text,$be_outside_the_law;?></font>";
          nine.setAttribute('class','am-form-group am-form-error am-form-icon am-form-feedback');
        }else{
            nineth.setAttribute('class','am-icon-check');
            nineth.setAttribute('style','display;margin-right:20px;');
            nineth.innerHTML = "";
            nine.setAttribute('class','am-form-group am-form-success am-form-icon am-form-feedback');
        }
    }
 }


</script>
</head>
<body>
<!--[if lte IE 9]>
<p class="browsehappy">你正在使用<strong>过时</strong>的浏览器，Amaze UI 暂不支持。 请 <a href="http://browsehappy.com/" target="_blank">升级浏览器</a>
  以获得更好的体验！</p>
<![endif]-->

<?php
	// header
	include 'templates/header.htm';
?>

<div class="am-cf admin-main">
  <!-- sidebar start -->
  <?php
	// 左边栏
	include 'templates/sidebar.htm';
  ?>
  <!-- sidebar end -->

  <!-- content start -->
  <div class="admin-content">
    <div class="am-cf am-padding">
      <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg"><?=$new_businesses_text?></strong></div>
    </div>

    <hr/>

    <div class="am-g">

      <div class="am-u-sm-12 am-u-md-4 am-u-md-push-8">
        <div class="am-panel am-panel-default">
          <div class="am-panel-bd">
            <div class="am-g">
              <div class="am-u-md-12">
                <img id="showimg" class="am-img-circle am-img-thumbnail" src="<?php if(isset($pic))echo $pic;?>" alt=""/>
              </div>
              <div class="am-u-md-12">
                <p><?=$merchant_pic_text?></p>
                <form class="am-form">
                  <div class="am-form-group">
						<div class="btn">
							<span><?=$upload_pic_text?></span>
							<input id="fileupload" type="file" name="mypic">
						</div>
						<div class="progress">
							<span class="bar"></span><span class="percent">0%</span >
						</div>
						<div class="files"></div>
                    <p class="am-form-help"><?=$choose_file_text?>...</p>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>

      </div>

      <div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4"><!--onsubmit="return uptext();"-->
        <form action="doSeller.php" onSubmit="return uptext();" id="form" method="post" class="am-form am-form-horizontal">
			<input type="hidden" name="action" value="<?=$action?>" />
			<input type="hidden" name="id" value="<?php if(isset($id))echo $id;?>" />
			<input type="hidden" name="path" value="<?php if(isset($path))echo $path;?>" />
			<input type="hidden" id="_pic" name="pic" value="<?php if(isset($pic))echo $pic;?>" />
			<input type="hidden" id="_intro" name="intro" value="" />
			<input type="hidden"  name="is_on" value="0" /> 
			<input type="hidden" name="page" value="<?php if(isset($page))echo $page;?>" />
			<div class="am-form-group " id="one">
				<label for="user-name" class="am-u-sm-3 am-form-label"><?=$merchant_name_text?>(<?=$input_english?>) </label>
				<div class="am-u-sm-9 ">
				  <input type="text" name="sellerName" value="<?php if(isset($sellerName))echo $sellerName;?>" id="user-name" placeholder="<?=$merchant_name_text?>">   <span style="display:none" id="first"class="" ></span>
				
				  <!--<small class="am-text-danger">商户名称不能为空</small>-->
				</div>
			</div>
      <div class="am-form-group">
        <label for="dishNameCN" class="am-u-sm-3 am-form-label"><?=$merchant_name_text?>(<?=$input_chinese?>,<?=$input_thai?>)</label>
        <div class="am-u-sm-9">
          <ul class="am-avg-sm-2">
            <li><input type="text" onkeyup="openFlag($(this),1,'sellerNameCN,sellerNameTHAI',1)" onkeydown="closeFlag()" name="sellerNameCN" value="<?php if(isset($sellerNameCN))echo $sellerNameCN;?>" id="sellerNameCN" placeholder="<?=$input_chinese?>"></li>
            <li><input type="text" onkeyup="openFlag($(this),2,'sellerNameCN,sellerNameTHAI',1)" onkeydown="closeFlag()" name="sellerNameTHAI" value="<?php if(isset($sellerNameTHAI))echo $sellerNameTHAI;?>" id="sellerNameTHAI" placeholder="<?=$input_thai?>"></li>
          </ul>
        </div>
      </div>
      <!--商户地址-->
          <div class="am-form-group"  id="s">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$merchant_address_text?></label>
            <div class="am-u-sm-9">
     <input type="text" name="mer_address" value="<?php if(isset($mer_address))echo $mer_address;?>" placeholder="<?=
              $merchant_address_text?>"><span id="sth"class="" style="display:none"></span>
            </div>
          </div>
      <!--商户坐标-->
          <div class="am-form-group" id="five">
            <label for="user-email" class="am-u-sm-3 am-form-label"><?=$map_coordinates_text?></label>
            <div class="am-u-sm-7">
              <input type="text" name="coordinates" value="<?php if(isset($coordinates))echo $coordinates;?>" id="user-email" placeholder="<?=$map_coordinates_text?>"><span id="fifth"class="" style="display:none"></span>
            </div>
            <div class="am-u-sm-2">
              <a type="button" class="am-btn am-btn-secondary" target="_blank" href="https://www.google.com/maps?hl=zh-CN&tab=wl"><?=$coordinate_text?></a>
            </div>
          </div>

          <div class="am-form-group"  id="six">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$share_information_text?></label>
            <div class="am-u-sm-9">
              <input type="text" name="address" value="<?php if(isset($address))echo $address;?>" id="share" placeholder="<?=$share_information_text?>"><span id="sixth"class="" style="display:none"></span>
            </div>
          </div>
		  
		  
           <div class="am-form-group">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$icon_text?></label>
            <div class="am-u-sm-9">
            <?php foreach($extraList as $v){ ?>           
			<!--<img src="<?php //echo $v['ser_icon'];?>" />-->
			
			<label class="am-checkbox-inline">
             <input type="checkbox" name="<?php echo $v['ser_id'];?>" value="<?php echo $v['ser_name'];?>" <?php echo $v['status']?'checked':'';?> /> <?php echo $v['ser_name'];?>
			 </label>
			<?php }?>

     	</div>
          </div>
              <div class="am-form-group">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$restaurant_type_text?></label>
            <div class="am-u-sm-9">
            <?php foreach($rtypeList as $v){ ?>           
			<!--<img src="<?php //echo $v['ser_icon'];?>" />-->
			
			<label class="am-checkbox-inline">
             <input type="checkbox" name="checkbox[]" value="<?php echo $v['rt_name'];?>" <?php echo $v['status']?'checked':'';?>/> <?php echo $v['rt_name'];?>
			 </label>
			<?php }?>

     	</div>
          </div>
    <!--是否推荐-->  
      <div class="am-form-group">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$is_rec_text?></label>
            <div class="am-u-sm-9">
            <label class="am-radio-inline">
              <input type="radio" name="is_rec" value="1"  <?php if(isset($is_rec)&&$is_rec==1){echo 'checked';}?>>  <?=$yes_text?>
            </label>
            <label class="am-radio-inline">
              <input type="radio" name="is_rec" value="0"   <?php if(isset($is_rec)&&$is_rec==0){echo 'checked';}?>> <?=$no_text?>
            </label>
            </div>
          </div>
  <!--在线支付-->   
        <div class="am-form-group" >
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$online_payment_text?></label>
            <div class="am-u-sm-9" >
            <label class="am-radio-inline" style= "text-align: center;">
              <input type="radio" name="online_pay" value="1"  <?php if(isset($online_pay)&&$online_pay==1){echo 'checked';}?>><?=$yes_text?>
            </label>
            <label class="am-radio-inline">
              <input type="radio" name="online_pay" value="0"  <?php if(isset($online_pay)&&$online_pay==0){echo 'checked';}?>> <?=$no_text?>
            </label>
            </div>
          </div>
	
      <div class="am-form-group"  id="seven">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$contact_person_text?></label>
            <div class="am-u-sm-9">
              <input type="text" name="contacts" value="<?php if(isset($contacts))echo $contacts;?>" id="user-phone" placeholder="<?=$contact_person_text?>"><span id="seventh"class="" style="display:none"></span>
            </div>
          </div>

          <div class="am-form-group" id="two">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$phone_text?></label>
            <div class="am-u-sm-9">
              <input type="text" name="tel" value="<?php if(isset($tel))echo $tel;?>" id="user-phone" placeholder="<?=$phone_text?>"><span id="second"class="" style="display:none"></span>
            </div>
          </div>
          <div class="am-form-group" id="eight">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$business_hour_text?></label>
            <div class="am-u-sm-9">
              <input type="text" name="BH" value="<?php if(isset($BH))echo $BH;?>" id="user-phone" placeholder="<?php echo $business_hour_text;?>"><span id="eighth"class="" style="display:none"></span>
		
            </div>
          </div>
               <div class="am-form-group" id="nine">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$required_QRcode_number_text?></label>
            <div class="am-u-sm-9">
   	<input type="text" name="QRcode_sum" value="<?php if(isset($QRcode_sum))echo $QRcode_sum;?>" id="user-phone" placeholder="<?=$required_QRcode_number_text?>"><span id="nineth"class="" style="display:none"></span>
            </div>
          </div>

          <!--<div class="am-form-group">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$country_text?></label>
            <div class="am-u-sm-9">
			  <input name="country" class="am-u-sm-3" id="countryValue" value="<?=$country?>" placeholder="<?=$country_text?>"/>
			  <input name="state" class="am-u-sm-3" id="stateValue" value="<?=$state?>" placeholder="<?=$state_text?>"/>
			  <input name="city" class="am-u-sm-3" id="cityValue" value="<?=$city?>" placeholder="<?=$city_text?>"/>
			  <input name="region" class="am-u-sm-3" id="regionValue" value="<?=$region?>" placeholder="<?=$region_text?>"/>
			
			  <hr/>
			
			  <div class="selectCountry" data-index="0" id="country" value="<?=$country?>"></div>
			  <div class="selectCountry" data-index="1" id="state" value="<?=$state?>"></div>
			  <div class="selectCountry" data-index="2" id="city" value="<?=$city?>"></div>
			  <div class="selectCountry" data-index="3" id="region" value="<?=$region?>"></div>-->
              <!--<input type="text" name="country" value="<?php if(isset($country))echo $country;?>"  id="user-phone" placeholder="<?=$country_text?>">-->
            <!--</div>
          </div>-->

          <div class="am-form-group">
            <label for="user-phone" class="am-u-sm-3 am-form-label"><?=$referee_text?></label>

            <div class="am-u-sm-9">
				<select name="referee" data-am-selected="{searchBox: 1}">
					  <?php
						foreach($referees as $k => $v){
							if($referee == $v['id'])
								echo '<option selected value="'.$v['id'].'">'.$v['username'].'</option>';
							else
								echo '<option value="'.$v['id'].'">'.$v['username'].'</option>';
						}
					  ?>
				</select>
            </div>
          </div>

          <div class="am-form-group">
            <label for="user-intro" class="am-u-sm-3 am-form-label"><?=$intro_text?></label>
            <div class="am-u-sm-9">
				<script type="text/plain" id="myEditor" style="width:100%;height:240px;">
					<?php if(isset($intro))echo $intro;?>
				</script>
            </div>
          </div>

          <div class="am-form-group">
            <div class="am-u-sm-9 am-u-sm-push-3">
              <button type="submit" class="am-btn am-btn-primary"><?=$save_text?></button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- content end -->

</div>

<a class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}"></a>

<?php
	// footer
	include 'templates/footer.htm';
?>

<!--[if lt IE 9]>
<script src="http://libs.baidu.com/jquery/1.11.1/jquery.min.js"></script>
<script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
<script src="assets/js/polyfill/rem.min.js"></script>
<script src="assets/js/polyfill/respond.min.js"></script>
<script src="assets/js/amazeui.legacy.js"></script>
<![endif]-->

<!--[if (gte IE 9)|!(IE)]><!-->
<script src="templates/assets/js/jquery.min.js"></script>
<script src="templates/assets/js/jquery.form.js"></script>
<script src="templates/assets/js/jquery.Jcrop.js"></script>
<script src="templates/assets/js/amazeui.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/umeditor/umeditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/umeditor/umeditor.min.js"></script>
<script type="text/javascript" src="/js/umeditor/lang/zh-cn/zh-cn.js"></script>
<!--<![endif]-->
<script>
	(function($) {
	  'use strict';

	  $(function() {
		var $fullText = $('.admin-fullText');
		$('#admin-fullscreen').on('click', function() {
		  $.AMUI.fullscreen.toggle();
		});

		$(document).on($.AMUI.fullscreen.raw.fullscreenchange, function() {
		  $.AMUI.fullscreen.isFullscreen ? $fullText.text('<?=$close_full_text?>') : $fullText.text('<?=$open_full_text?>');
		});
	  });
	})(jQuery);
</script>
<script>
	(function($){
		$.fn.extend({
			GlobalGeography:function(){
				 
				/* ._GlobalGeography_ { width:282px; height:30px !important; position:relative; left:-282px; top:2px; } */
				 
				var relatedObj = ['div[id="country"]','div[id="state"]','div[id="city"]','div[id="region"]'];
				var excludeObj = ['div[id="region"]'];   
				var selectmenu = ['country','state','city','region'];
				var selector   = this.selector;
				 
				/*输出下拉列表*/
				function _traversal(source,type,text){
					//console.log(source);
				
					if(typeof(source)!='undefined'){
						var _select_  = '<select class="_GlobalGeography_">';
							_select_ += '<option value=""></option>';
						$.each(source,function(i,v){
							//console.log(v.Name+":"+v.Code);
							if(typeof(text)!='undefined' && text == v.Name)
								_select_ += '<option selected value="'+v.Code+'">'+v.Name+'</option>';
							else 
								_select_ += '<option value="'+v.Code+'">'+v.Name+'</option>';
						});
						_select_ += '</select>';
						return _select_;
					}
					return false;
				};
				 
				/*清除/还原下级关联下拉菜单*/
				function cleanNextMenu(index){
					for(var i=index;i<relatedObj.length;i++){
						if(typeof(relatedObj[(i+1)])!='undefined'){
							$(relatedObj[(i+1)]).find('._GlobalGeography_').remove();
							$(relatedObj[(i+1)]).find('input').val('');
						}
					}
				}
				
				/* 初始化 */
				function initValue(i){
					i++;
				
					for(i;i<selectmenu.length;i++){
						//console.log("index:"+i);
						$("#"+selectmenu[i]+"Value").val("");
					}
				}
				 
				/*遍历获取下拉菜单内容*/
				function checkMenu(json){				
					/*遍历赋值所有类型*/
					$.each(relatedObj,function(i,v){
						if($.inArray(v,excludeObj)==-1){
							$(v).find('select').bind('change',function(){
								var _code_ = $(this).val(); cleanNextMenu(i);
								if(typeof(json[selectmenu[(i+1)]][_code_])!='undefined'){
									//console.log("i+1:"+selectmenu[(i+1)]+":"+_code_);
								
									$(relatedObj[(i+1)]).append(_traversal(json[selectmenu[(i+1)]][_code_],selectmenu[(i+1)]));
									/*绑定方法*/
									$(relatedObj[(i+1)]).find('._GlobalGeography_').bind('change',function(){
										$(relatedObj[(i+1)]).find('input').val($(this).find('option:selected').text());
									});
									checkMenu(json);
								} else {
									if(typeof(selectmenu[(i+2)]) != 'undefined' && typeof(json[selectmenu[(i+2)]][_code_]) != 'undefined'){										
										$(relatedObj[(i+2)]).append(_traversal(json[selectmenu[(i+2)]][_code_]));
										/*绑定方法*/
										$(relatedObj[(i+2)]).find('._GlobalGeography_').bind('change',function(){
											$(relatedObj[(i+2)]).find('input').val($(this).find('option:selected').text());
										});
										checkMenu(json);
									}
								}
							});
						}
					});
					
					/* 为生成的新元素添加事件 */
					$(".selectCountry select").on('change',function(){
						var text = $(this).find("option:selected").text();
						var id = $(this).parent(".selectCountry").attr("id");
						var i = $(this).parent(".selectCountry").data("index");
						
						initValue(i);
						$("#"+id+"Value").val(text);
					});
				}
				 
				/*加载世界国家城市数据*/
				$.getJSON("getCountry.php",function(json){
					/*输出国家列表*/
					$(selector).append(_traversal(json.country,'country'));
					$(selector).find('._GlobalGeography_').bind('change',function(){
						$(selector).find('input').val($(this).find('option:selected').text());
					});
					checkMenu(json);
				});
			}
		})
	})(jQuery);
	
	$(document).ready(function(){
		$('#country').GlobalGeography();
	});

	var um = UM.getEditor('myEditor');
	var flag = 1;

	$(function(){
		var bar = $('.bar');
		var percent = $('.percent');
		var showimg = $('#showimg');
		var progress = $(".progress");
		var files = $(".files");
		var btn = $(".btn span");
		var pic = $("#_pic");
		
		$("#fileupload").wrap("<form id='myupload' action='uploadAction.php' method='post' enctype='multipart/form-data'></form>");
		$("#fileupload").change(function(){
				$("#myupload").ajaxSubmit({
					dataType:  'json',
					beforeSend: function() {
						showimg.attr('src','');
						progress.show();
						var percentVal = '0%';
						bar.width(percentVal);
						percent.html(percentVal);
						btn.html("上传中...");
						flag = -1;
					},
					uploadProgress: function(event, position, total, percentComplete) {
						var percentVal = percentComplete + '%';
						bar.width(percentVal);
						percent.html(percentVal);
					},
					success: function(data) {
						//files.html("<b>"+data.name+"("+data.size+"k)</b> <span class='delimg' rel='"+data.pic+"'><?=$delete_text?></span>");
						files.hide();
						var img = data.pic;
						showimg.attr('src', img);
						pic.val(img);
						btn.html("<?=$upload_success_text?>！");
						flag = 1;
						//btn.html("<a rel='"+data.pic+"' href='javascript:;' class='c_button'><img src='/member/resources/img/crop_button.png'></a>");
						//btn.show();
					},
					error:function(xhr){
						files.show();
						alert("<?=$upload_pic_error?>");
						btn.html("<?=$upload_pic_error?>");
						bar.width('0')
						files.html(xhr.responseText);
						flag = 1;
					}
				});
			});
	});
	
	function uptext(){
            var user = document.getElementsByName('sellerName')[0].value;
           var map = document.getElementsByName('coordinates')[0].value; 
            var share = document.getElementById('share').value; 
            var contacts = document.getElementsByName('contacts')[0].value; 
            var phone = document.getElementsByName('tel')[0].value; 
            var business_hour = document.getElementsByName('BH')[0].value; 
            var QRcode_sum = document.getElementsByName('QRcode_sum')[0].value; 
       

            if (user==''||user==undefined||user==null) {
              alert('<?php echo $please_write,$merchant_name_text?>');
              return false;
            }
           
            if (map==''||map==undefined||map==null) {
              alert('<?php echo $please_write,$map_coordinates_text?>');
              return false;
            }
            if (share==''||share==undefined||share==null) {
              alert('<?php echo $please_write,$share_information_text?>');
              return false;
            }
            if (contacts==''||contacts==undefined||contacts==null) {
              alert('<?php echo $please_write,$contact_person_text?>');
              return false;
            }
            if (phone==''||phone==undefined||phone==null) {
              alert('<?php echo $please_write,$phone_text?>');
              return false;
            }
            if (business_hour==''||business_hour==undefined||business_hour==null) {
      
              alert('<?php echo $please_write,$business_hour_text?>');
              return false;
            }
            if (QRcode_sum==''||QRcode_sum==undefined||QRcode_sum==null) {
              alert('<?php echo $please_write,$required_QRcode_number_text?>');
              return false;
            }else if(isNaN(QRcode_sum)){
               alert('<?php echo $required_QRcode_number_text,$be_outside_the_law?>');
              return false;
            }

		$("#_intro").val(UM.getEditor('myEditor').getContent());
		
		if(flag == 1){
			return true;
		}else if(flag == -1){
			alert("is verifying the picture, please wait a moment!");
			return false;
		}
	}
</script>
</body>
</html>
